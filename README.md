# WordZero - Golang Word操作库

[![Go Version](https://img.shields.io/badge/Go-1.19+-00ADD8?style=flat&logo=go)](https://golang.org)
[![License](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
[![Tests](https://img.shields.io/badge/Tests-Passing-green.svg)](#测试)

## 项目介绍

WordZero 是一个使用 Golang 实现的 Word 文档操作库，提供基础的文档创建、修改等操作功能。该库遵循最新的 Office Open XML (OOXML) 规范，专注于现代 Word 文档格式（.docx）的支持。

### 核心特性

- 🚀 **完整的文档操作**: 创建、读取、修改 Word 文档
- 🎨 **丰富的样式系统**: 18种预定义样式，支持自定义样式和样式继承
- 📝 **文本格式化**: 字体、大小、颜色、粗体、斜体等完整支持
- 📐 **段落格式**: 对齐、间距、缩进等段落属性设置
- 🏷️ **标题导航**: 完整支持Heading1-9样式，可被Word导航窗格识别
- ⚡ **高性能**: 零依赖的纯Go实现，内存占用低
- 🔧 **易于使用**: 简洁的API设计，链式调用支持

## 安装

```bash
go get github.com/ZeroHawkeye/wordZero
```

## 项目结构

```
wordZero/
├── pkg/                      # 公共包
│   ├── document/            # 文档核心操作
│   │   ├── document.go      # 主要文档操作API
│   │   ├── table.go         # 表格操作功能
│   │   ├── errors.go        # 错误定义和处理
│   │   ├── logger.go        # 日志系统
│   │   ├── doc.go           # 包文档
│   │   ├── document_test.go # 文档操作单元测试
│   │   └── table_test.go    # 表格功能单元测试
│   └── style/               # 样式管理系统
│       ├── style.go         # 样式核心定义
│       ├── api.go           # 快速API接口
│       ├── predefined.go    # 预定义样式常量
│       ├── api_test.go      # API测试
│       ├── style_test.go    # 样式系统测试
│       └── README.md        # 样式系统详细文档
├── examples/                 # 使用示例
│   ├── basic/               # 基础功能示例
│   │   └── basic_example.go
│   ├── formatting/          # 格式化示例
│   │   └── text_formatting_example.go
│   ├── style_demo/          # 样式系统演示
│   │   └── style_demo.go
│   ├── table/               # 表格功能示例
│   │   └── table_example.go
│   ├── table_layout/        # 表格布局和尺寸示例
│   │   └── main.go
│   ├── table_style/         # 表格样式和外观示例
│   │   └── main.go
│   ├── cell_advanced/       # 单元格高级功能示例
│   │   └── main.go
│   ├── basic_usage.go       # 基础使用示例
│   └── output/             # 示例输出文件目录
├── test/                    # 集成测试文件
│   ├── document_test.go     # 文档操作集成测试
│   ├── text_formatting_test.go # 文本格式化集成测试
│   └── table_style_test.go  # 表格样式功能集成测试
├── .gitignore              # Git忽略文件配置
├── go.mod                  # Go模块定义
├── LICENSE                 # MIT许可证
└── README.md              # 项目说明文档
```

## 功能特性

### ✅ 已实现功能

#### 文档基础操作
- [x] 创建新的 Word 文档
- [x] 读取和解析现有文档  
- [x] 文档保存和压缩
- [x] ZIP文件处理和OOXML结构解析

#### 文本和段落操作
- [x] 文本内容的添加和修改
- [x] 段落创建和管理
- [x] 文本格式化（字体、大小、颜色、粗体、斜体）
- [x] 段落对齐（左对齐、居中、右对齐、两端对齐）
- [x] 行间距和段间距设置
- [x] 首行缩进和左右缩进
- [x] 混合格式文本（一个段落中多种格式）

#### 样式管理系统
- [x] **预定义样式库**: 18种Word内置样式
  - [x] 标题样式（Heading1-Heading9）- 支持导航窗格识别
  - [x] 正文样式（Normal）
  - [x] 文档标题和副标题（Title、Subtitle）
  - [x] 引用样式（Quote）
  - [x] 列表段落样式（ListParagraph）
  - [x] 代码相关样式（CodeBlock、CodeChar）
  - [x] 字符样式（Emphasis、Strong）
- [x] **样式继承机制**: 完整的样式继承和属性合并
- [x] **自定义样式**: 快速创建和应用自定义样式
- [x] **样式查询API**: 按类型查询、样式验证、批量操作
- [x] **快速应用API**: 便捷的样式操作接口

> **样式数量说明：** 系统内置18个预定义样式（15个段落样式 + 3个字符样式）。演示程序中显示的21个样式是因为动态创建了3个自定义样式进行功能展示。

#### 表格功能

##### 表格基础操作
- [x] 表格创建和初始化
  - [x] 创建指定行列数的表格
  - [x] 设置表格初始数据
  - [x] 表格插入到文档指定位置
- [x] 表格结构管理
  - [x] 插入行（指定位置、末尾、开头）
  - [x] 删除行（单行、多行、指定范围）
- [x] 表格复制和剪切
- [x] 表格删除和清空

##### 单元格操作
- [x] 单元格内容管理
  - [x] 单元格文本设置和获取
  - [x] 单元格富文本格式支持
  - [x] 单元格内容清空和重置
- [x] 单元格合并功能
  - [x] 横向合并（合并列）
  - [x] 纵向合并（合并行）
  - [x] 区域合并（多行多列）
  - [x] 取消合并操作
  - [x] 合并状态查询
- [x] 单元格格式设置
  - [x] 单元格文字格式（字体、大小、颜色）
  - [x] 单元格对齐方式（水平、垂直对齐）
  - [x] 单元格文字方向和旋转
  - [x] 单元格内边距设置

##### 表格布局和尺寸
- [x] 表格尺寸控制
  - [x] 表格总宽度设置（固定宽度、相对宽度、自动宽度）
  - [x] 列宽设置（固定宽度、相对宽度、自动调整）
  - [x] 行高设置（固定高度、最小高度、自动调整）
  - [x] 单元格尺寸精确控制
- [x] 表格对齐和定位
  - [x] 表格页面对齐（左对齐、居中、右对齐）
  - [x] 表格文字环绕设置
  - [x] 表格相对定位
- [x] 表格分页控制
  - [x] 表格跨页处理
  - [x] 标题行重复显示
  - [x] 表格分页符控制
  - [x] 避免分页的行设置

##### 表格数据处理
- [x] 数据导入导出
  - [x] 二维数组数据绑定
  - [x] 表格数据提取为数组
  - [x] 批量数据填充

##### 表格访问和查询
- [x] 表格查找和定位
  - [x] 按索引获取表格
  - [x] 表格位置信息获取
- [x] 单元格访问接口
  - [x] 按行列索引访问

##### 表格样式和外观
- [x] 表格整体样式
  - [x] 预定义表格样式模板
  - [x] 自定义表格样式创建
  - [x] 表格主题色彩应用
  - [x] 表格样式继承和覆盖
- [x] 表格边框设置
  - [x] 外边框样式（线型、颜色、粗细）
  - [x] 内边框样式（网格线设置）
  - [x] 单元格边框独立设置
  - [x] 边框部分应用（顶部、底部、左右）
  - [x] 无边框表格支持
- [x] 表格背景和填充
  - [x] 表格背景色设置
  - [x] 单元格背景色设置
  - [x] 奇偶行颜色交替
  - [x] 渐变背景支持（基础渐变）
  - [x] 图案填充支持

### 🚧 规划中功能

#### 表格功能完善

##### 高级表格功能
- [ ] 表格排序功能（Word内置排序）
  - [ ] 单列排序（升序、降序）
  - [ ] 多列排序
  - [ ] 保持标题行不参与排序
- [ ] 表格标题和说明
  - [ ] 表格标题设置（表格上方、下方）
  - [ ] 表格标题编号自动生成
  - [ ] 表格描述和备注
- [ ] 嵌套表格支持
  - [ ] 单元格内嵌套表格
  - [ ] 嵌套表格独立样式
- [ ] 表格模板功能
  - [ ] 常用表格模板库
  - [ ] 自定义模板保存
  - [ ] 模板快速应用
- [ ] 表格访问增强
  - [ ] 按标题查找表格
  - [ ] 按范围批量访问
  - [ ] 单元格遍历迭代器

#### 图片功能  
- [ ] 图片插入
- [ ] 图片大小调整
- [ ] 图片位置设置
- [ ] 多种图片格式支持（JPG、PNG、GIF）

#### 页面设置功能
- [ ] 页面大小设置（A4、Letter、Legal等标准尺寸）
- [ ] 自定义页面尺寸
- [ ] 页面方向设置（纵向/横向）
- [ ] 页面边距设置（上下左右边距）
- [ ] 页面分节和分页控制

#### 高级功能
- [ ] 页眉页脚
- [ ] 目录生成
- [ ] 页码设置
- [ ] 文档属性设置（作者、标题等）
- [ ] 列表和编号
- [ ] 脚注和尾注

## 使用示例

查看 `examples/` 目录下的示例代码：

- `examples/basic/` - 基础功能演示
- `examples/style_demo/` - 样式系统演示  
- `examples/table/` - 表格功能演示
- `examples/table_layout/` - 表格布局和尺寸演示
- `examples/formatting/` - 格式化演示

运行示例：
```bash
# 运行基础功能演示
go run ./examples/basic/

# 运行样式演示
go run ./examples/style_demo/

# 运行表格演示
go run ./examples/table/

# 运行表格布局和尺寸演示
go run ./examples/table_layout/

# 运行格式化演示  
go run ./examples/formatting/
```

## 开发指南

### 项目开发规则

1. **项目结构**: 符合golang依赖库的项目结构，完善的测试流程
2. **模块化设计**: 规范的项目结构，避免文件循环依赖和过渡耦合
3. **测试规范**: 测试用例尽量放在test目录下
4. **文档维护**: 每次完成一个功能点需更新README文件的待办列表

### 贡献指南

欢迎提交 Issue 和 Pull Request！在提交代码前请确保：

1. 代码符合 Go 代码规范
2. 添加必要的测试用例
3. 更新相关文档
4. 确保所有测试通过

## 许可证

本项目采用 MIT 许可证。详见 [LICENSE](LICENSE) 文件。